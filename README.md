install_zabbix_nginx_ssl_role
=========

Ansible Role to install zabbix monitoring server and nginx with ssl certificate, generated by letsencrypt.
Also the role does automatic action like: creating users, creating users groups, change logo and icon, install languages and configure Email settings.

Role Variables
--------------
Variables are located in [deafults/main.yml](defaults/main.yml) file.

**General Parameters**
---------------------

**hostname** --> Full name of the DNS pointed to the Machine IP (server.my.domain).
**domain** --> The domain if the DNS of the server.
**hostname_no_fqdn** --> The name of the server without the domain ending.
**install_nginx** --> Set true to install nginx (must be **true** for first installation).
**install_mariadb** --> Set true to install mariaDB (must be **true** for first installation).
**install_php** --> Set true to install php (must be **true** for first installation).
**install_zabbix** --> --> Set true to install zabbix (must be **true** for first installation).
**add_host** --> Set true just if you are installing zabbix again with existig DB and sql user.

**MariaDB parameters**
---------------------
**mysql_root_password** --> Root Password for mariaDB.


**letsencrypt parameters**
---------------------
**certbot_admin_email** --> Email Address for letsencrypt certificate generation.

**zabbix parameters**
---------------------
**version** --> General version (5.0,4.0)
**sub_version** '5.0-1' # Specifip version
**zabbix_db_name** --> zabbix Database name.
**zabbix_db_user** --> zabbix Database user.
**zabbix_db_password** --> zabbix Database user password.
**admin_user** --> Admin user fir zabbix.
**admin_password** --> Admin password for zabbix.

**abbix Favicon parameters
**change_favicon** --> Set True for changing favicon.
**favicon_src** --> Path to favicon on the local host.

## Zabbix logo parameters
**change_logo** --> Set True for changing logo.
**logo_src** --> Path to logo svg file on the local host.

## Zabbix Creating user parameters

When you want to add one or more users, add to the list a dictionary contains all the below keys and give them values by your choice.

**create_user** --> Set true to create users.
**username** --> Username.
**user_password** --> User Password
**user_type** --> 1- Zabbix user, 2- Zabbix Admin, 3- Zabbix Super Admin.
**user_id:** --> IMPORTANT! Every run increase this var by 1, if you forgot the counting, set random nuber ( like 85, 869, 7996...) **Begin WITH 3!**.
**add_to_group** --> Group to add, can be Guests or Disabled or Zabbix administrators.
**adding_group_id** --> {{ (<user_id> + 2 }} IMPORTANT! the left opretor is user_id!

**Example**

```bash
create_user: false
users:
  - user_id: 8
    username: gal8 
    name: gal
    surename: Birkman
    user_password: 'Aa123456' 
    user_type: 3  
    add_to_group: 'Zabbix administrators'
    adding_group_id: "{{ 8 + 2 }}" ## IMPORTANT! the left opretor is user_id!

  - user_id: 9
    username: gal9
    name: Gal
    surename: Birk
    user_password: 'Aa123456'
    user_type: 1
    add_to_group: 'Clients'
    adding_group_id: "{{ 9 + 2 }}"
```


Example Playbook
----------------
Before you run fill the paraneters in [deafults/main.yml](defaults/main.yml), <b>OR</b> set vars section in the playbook file:

```bash
- hosts: servers
  vars:
    - var1
    - var2
  roles:
    - install_zabbix_nginx_ssl_role
```
Every variable that will not entered above, his value will be taken from the defaults file.

Playbook after filling [deafults/main.yml](defaults/main.yml).

    - hosts: servers
      roles:
         - install_zabbix_nginx_ssl_role

License
-------

BSD

Author Information
------------------

<b>Gal Birkman, DevOps Engineer.</b><br>
<b>email:</b> galbirkman@gmail.com<br>
<b>GitHub:</b> https://github.com/galbirk
